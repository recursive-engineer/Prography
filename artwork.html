<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel="stylesheet" href="scss/header.css">
        <link href="colored-code/src/prettify.css" type="text/css" rel="stylesheet">
        <script type="text/javascript" src="colored-code/src/prettify.js"></script>
        <!--<link rel="stylesheet" href="scss/artwork-mobile.css" media="screen and (max-width:559px)">-->
        <link rel="stylesheet" href="scss/artwork-pc.css?v=2" media="screen" type='text/css'>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script type="text/javascript">
            var art_id=1;
        </script>
        <title>Prography</title>
    </head>
    <body onload="prettyPrint()">
        <iframe id="header" src="header.html" width="100%" height="50px" frameborder="0"></iframe>
        <div class="outer_frame">
            <div class="inner_frame">
                <?php
                    try {
                        $db = new PDO('mysql:dbname=prography;host=localhost;charset=utf8','root','root');
                    } catch (PDOException $e) {
                        echo 'DB接続エラー!: ' . $e->getMessage();
                    }
                    $result = $db->query('select code from artwork where id=1');
                    if (!$result) {
                        $sql_error = $db->error;
                        echo 'select failed.<br>' ;
                        error_log($sql_error);
                        die($sql_error);
                        
                    } else {
                        $html=$result->fetch(PDO::FETCH_ASSOC);
                        $code=htmlspecialchars($html['code'], ENT_QUOTES, 'UTF-8');
                        //echo $code;
                        //echo $html["code"];
                    }
                ?>
                <div id="artwork">
                    <?php echo $html["code"]; ?>
                </div>
                <div id="code-area">
                    <div id="buttons">
                        <button id="file-menu" class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">ファイル選択</button>
                        <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">HTML</a></li>
                        <li><a class="dropdown-item" href="#">CSS</a></li>
                        <li><a class="dropdown-item" href="#">JavaScript</a></li>
                        </ul>
                        <button id="submit" type="submit" name="button">投稿</button>
                    </div>
                    <textarea id="code" name='codeA' cols="30" rows="15">
                        <pre class="prettyprint">
                            <code class="prettyprint">
                                <?php echo $code; ?>
                            </code>
                        </pre>
                    </textarea> 
                </div>
            </div>
            <div id="caption" class="d-flex">
                <div id="titles">
                    <p id="title">Title Here</p>
                    <p id="subtitle">Subtitle Here</p>
                </div>
                <div id="author_frame" class="d-flex">
                    <div id="author_icon"></div>
                    <div id="author_info">
                        <p id="author_name">Author Name Here</p>
                        <p id="author_profession">Profession Here</p>
                        <button class="btn" type="submit">Follow</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="viewers">
            <div id="floor">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div id="viewer"></div>
        </div>
        <div id="reputation">
        </div>
        <script type="text/javascript">
            var title=document.getElementById('title');
            var code=document.getElementById('code');
            var subtitle=document.getElementById('subtitle');
            var author_name=document.getElementById('author_name');
            var profession=document.getElementById('author_profession');
            var artwork=document.getElementById('artwork');
            //artwork.setAttribute("src","artwork"+art_id+".html");
            switch(art_id){
                case 1:
                    title.textContent="The Sierpinski";
                    author_name.textContent="RaiRai000";
                    break;
                case 2:
                    title.textContent="色空間におけるアフィン変換";
                    subtitle.textContent="The Affine-Transforming of Color-Space";
                    author_name.textContent="RaiRai000";
                    profession.textContent="Media Artist";
                    break;
                case 3:
                    title.textContent="空間描画";
                    subtitle.textContent="3d drawing";
                    author_name.textContent="RaiRai000";
                    profession.textContent="Media Artist";
                    break;
                default:
            }
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    </body>
</html>